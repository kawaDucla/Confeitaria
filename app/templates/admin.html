<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <title>Admin - Confeitaria</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">
</head>

<body>

    <div class="admin-container">
        <h2>Cadastro de Produtos</h2>

        <form method="POST" enctype="multipart/form-data" class="form-produto">
            <div class="form-group">
                <label for="nome">Nome do produto:</label>
                <input type="text" name="nome" id="nome" placeholder="Nome do produto" required>
            </div>

            <div class="form-group">
                <label for="preco_custo">Preço de custo:</label>
                <input type="number" step="0.01" name="preco_custo" id="preco_custo" placeholder="Preço de custo"
                    required>
            </div>

            <div class="form-group">
                <label for="valor_venda">Valor de venda:</label>
                <input type="number" step="0.01" name="valor_venda" id="valor_venda" placeholder="Valor de venda"
                    required>
            </div>

            <div class="form-group full-width">
                <label for="descricao">Descrição do produto:</label>
                <textarea name="descricao" id="descricao" placeholder="Descrição do produto" required></textarea>
            </div>

            <div class="form-group full-width">
                <label>Tipo de sabor:</label>
                <div class="tipo-sabor">
                    <label>
                        <input type="radio" name="tipo_sabor" value="um" checked onclick="toggle()"> Um sabor
                    </label>
                    <label>
                        <input type="radio" name="tipo_sabor" value="varios" onclick="toggle()"> Vários sabores
                    </label>
                </div>
            </div>

            <div class="form-group" id="um">
                <label for="sabor_unico">Sabor único:</label>
                <input type="text" name="sabor_unico" id="sabor_unico" placeholder="Sabor único">
            </div>

            <div class="form-group" id="varios" style="display:none;">
                <label for="sabores">Sabores separados por vírgula:</label>
                <textarea name="sabores" id="sabores" placeholder="Sabores separados por vírgula"></textarea>
            </div>

            <div class="form-group full-width">
                <label for="imagem">Imagem do produto:</label>
                <input type="file" name="imagem" id="imagem" accept="image/*">
            </div>

            <div class="form-group full-width">
                <label for="frase_botao">Frase do botão:</label>
                <input type="text" name="frase_botao" id="frase_botao" placeholder="Frase do botão" required>
            </div>

            <button type="submit">Cadastrar</button>
        </form>

        <h2>Produtos Cadastrados</h2>
        <div class="produtos-cadastrados">
            {% for produto in produtos %}
            <div class="produto-card">
                {% if produto.imagem %}
                <img src="{{ url_for('static', filename='img/produtos/' + produto.imagem) }}" alt="{{ produto.nome }}">
                {% else %}
                <div class="sem-imagem">Sem imagem</div>
                {% endif %}
                <div class="info">
                    <h3>{{ produto.nome }}</h3>
                    <p>{{ produto.descricao }}</p>
                    {% if produto.tipo_sabor == "um" %}
                    <p><strong>Sabor:</strong> {{ produto.sabor_unico }}</p>
                    {% else %}
                    <p><strong>Sabores:</strong> {{ produto.sabores }}</p>
                    {% endif %}
                    <p><strong>Custo:</strong> R$ {{ "%.2f"|format(produto.preco_custo) }} |
                        <strong>Venda:</strong> R$ {{ "%.2f"|format(produto.valor_venda) }} |
                        <strong>Lucro:</strong> R$ {{ "%.2f"|format(produto.lucro) }}
                    </p>

                    <div class="acoes-produto">
                        <a href="{{ url_for('main.editar_produto', id=produto.id) }}" class="btn-editar">Editar</a>
                        <a href="{{ url_for('main.deletar_produto', id=produto.id) }}" class="btn-deletar"
                            onclick="return confirm('Deseja realmente excluir este produto?');">Excluir</a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    <h2>Usuários Cadastrados</h2>
    <table border="1" cellpadding="8">
        <tr>
            <th>Foto</th>
            <th>Nome</th>
            <th>Email</th>
            <th>CPF</th>
            <th>Ações</th>
        </tr>
        {% for usuario in usuarios %}
        <tr>
            <td>
                <img src="{{ url_for('static', filename='img/usuarios/' + usuario.imagem) }}" width="50" height="50"
                    style="border-radius:50%;">
            </td>
            <td>{{ usuario.nome }}</td>
            <td>{{ usuario.email }}</td>
            <td>{{ usuario.cpf if usuario.cpf else '-' }}</td>
            <td>
                <a href="{{ url_for('main.editar_usuario', id=usuario.id) }}">Editar</a> |
                <a href="{{ url_for('main.deletar_usuario', id=usuario.id) }}"
                    onclick="return confirm('Deseja realmente excluir este usuário?');">Excluir</a>
            </td>
        </tr>
        {% endfor %}
    </table>


    <script>
        function toggle() {
            const tipo = document.querySelector('input[name="tipo_sabor"]:checked').value;
            document.getElementById("um").style.display = tipo === "um" ? "block" : "none";
            document.getElementById("varios").style.display = tipo === "varios" ? "block" : "none";
        }
    </script>

</body>

</html>